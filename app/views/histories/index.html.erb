<h1>履歴一覧</h1>
<div class="mb-6 text-lg font-bold">
  合計金額: <%= number_to_currency(@total_amount, unit: "", precision: 0) %>円　
  合計箱数: <%= @total_packs %>箱
</div>

<div class="mb-4">
  <%= form_with url: histories_path, method: :get, data: { turbo_frame: "histories_list" } do %>
    <label for="sort" class="font-bold mr-2">並び替え:</label>
    <%= select_tag :sort,
      options_for_select([
        ['購入日（新しい順）', 'date_desc'],
        ['購入日（古い順）', 'date_asc'],
        ['銘柄名（A→Z）', 'name_asc'],
        ['価格（高い順）', 'price_desc'],
        ['価格（安い順）', 'price_asc']
      ], params[:sort]),
      class: "border rounded p-1",
      onchange: "this.form.requestSubmit()" %> <!-- ← Turbo対応submit -->

    <label class="font-bold ml-4 mr-2">期間指定:</label>
    <%= date_field_tag :start_date, params[:start_date], class: "border rounded p-1" %> 〜
    <%= date_field_tag :end_date, params[:end_date], class: "border rounded p-1" %>

    <%= submit_tag '適用', class: "ml-2 bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 cursor-pointer" %>
    <%= link_to 'クリア', histories_path, class: "ml-2 bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500 cursor-pointer" %>
  <% end %>
</div>

  <!-- 📅 ショートカットボタン -->
  <div class="mt-2 space-x-2">
    <%= link_to "本日", histories_path(start_date: Date.current, end_date: Date.current), class: "bg-gray-200 px-3 py-1 rounded hover:bg-gray-300" %>
    <%= link_to "1週間", histories_path(start_date: 1.week.ago.to_date, end_date: Date.current), class: "bg-gray-200 px-3 py-1 rounded hover:bg-gray-300" %>
    <%= link_to "今月", histories_path(start_date: Date.current.beginning_of_month, end_date: Date.current.end_of_month), class: "bg-gray-200 px-3 py-1 rounded hover:bg-gray-300" %>
    <%= link_to "先月", histories_path(start_date: Date.current.last_month.beginning_of_month, end_date: Date.current.last_month.end_of_month), class: "bg-gray-200 px-3 py-1 rounded hover:bg-gray-300" %>
  </div>
  <br>


<turbo-frame id="histories_list">
  <%= render "histories/list", histories: @histories, total_amount: @total_amount, total_packs: @total_packs %>
</turbo-frame>